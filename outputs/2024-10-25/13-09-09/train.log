[2024-10-25 13:09:09,921][__main__][INFO] - Instantiating datamodule <src.datamodules.dogs_datamodule.DogsBreedDataModule>
[2024-10-25 13:09:11,121][__main__][INFO] - Instantiating model <src.models.dogs_classifier.DogsBreedClassifier>
[2024-10-25 13:09:12,062][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
[2024-10-25 13:09:12,504][timm.models._hub][INFO] - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-10-25 13:09:12,514][timm.models._builder][INFO] - Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
[2024-10-25 13:09:12,521][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-10-25 13:09:12,525][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-10-25 13:09:12,526][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-10-25 13:09:12,526][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-10-25 13:09:12,527][__main__][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-10-25 13:09:12,530][__main__][INFO] - Instantiating logger <lightning.pytorch.loggers.tensorboard.TensorBoardLogger>
[2024-10-25 13:09:12,533][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-10-25 13:09:12,541][pytorch_lightning.utilities.rank_zero][INFO] - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[2024-10-25 13:09:12,556][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: False, used: False
[2024-10-25 13:09:12,556][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-10-25 13:09:12,556][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-10-25 13:09:12,557][__main__][INFO] - Starting training!
[2024-10-25 13:09:12,557][src.datamodules.dogs_datamodule][INFO] - Checking for dataset in: /code/data/dogs_dataset/dataset
[2024-10-25 13:09:12,557][src.datamodules.dogs_datamodule][INFO] - Dataset already exists.
[2024-10-25 13:09:12,999][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-10-25 13:10:13,118][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer.fit` stopped: `max_epochs=1` reached.
[2024-10-25 13:10:13,130][__main__][INFO] - Training metrics:
{'train/loss': tensor(2.1010), 'train/loss_step': tensor(1.9219), 'train/acc': tensor(0.4874), 'train/acc_step': tensor(0.7368), 'val/loss': tensor(1.8388), 'val/loss_epoch': tensor(1.8388), 'val/acc': tensor(0.8921), 'val/acc_epoch': tensor(0.8921), 'train/loss_epoch': tensor(2.1010), 'train/acc_epoch': tensor(0.4874)}
[2024-10-25 13:10:13,131][__main__][INFO] - Starting testing!
[2024-10-25 13:10:13,131][__main__][INFO] - Loading best checkpoint: /code/checkpoints/best_model.ckpt
[2024-10-25 13:10:13,132][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /code/checkpoints/best_model.ckpt
[2024-10-25 13:10:13,191][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /code/checkpoints/best_model.ckpt
[2024-10-25 13:10:17,737][__main__][INFO] - Test metrics:
[{'test/loss_epoch': 1.834311842918396, 'test/acc_epoch': 0.8795180916786194}]
