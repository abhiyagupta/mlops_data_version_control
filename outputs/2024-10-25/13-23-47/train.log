[2024-10-25 13:23:47,429][__main__][INFO] - Instantiating datamodule <src.datamodules.dogs_datamodule.DogsBreedDataModule>
[2024-10-25 13:23:48,528][__main__][INFO] - Instantiating model <src.models.dogs_classifier.DogsBreedClassifier>
[2024-10-25 13:23:49,175][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
[2024-10-25 13:23:49,605][timm.models._hub][INFO] - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-10-25 13:23:49,617][timm.models._builder][INFO] - Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
[2024-10-25 13:23:49,624][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-10-25 13:23:49,628][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-10-25 13:23:49,629][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-10-25 13:23:49,630][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-10-25 13:23:49,631][__main__][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-10-25 13:23:49,634][__main__][INFO] - Instantiating logger <lightning.pytorch.loggers.tensorboard.TensorBoardLogger>
[2024-10-25 13:23:49,637][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-10-25 13:23:49,647][pytorch_lightning.utilities.rank_zero][INFO] - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[2024-10-25 13:23:49,664][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: False, used: False
[2024-10-25 13:23:49,664][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-10-25 13:23:49,664][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-10-25 13:23:49,665][__main__][INFO] - Starting training!
[2024-10-25 13:23:49,665][src.datamodules.dogs_datamodule][INFO] - Checking for dataset in: /code/data/dogs_dataset/dataset
[2024-10-25 13:23:49,666][src.datamodules.dogs_datamodule][INFO] - Dataset already exists.
[2024-10-25 13:23:50,042][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-10-25 13:24:47,055][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer.fit` stopped: `max_epochs=1` reached.
[2024-10-25 13:24:47,066][__main__][INFO] - Training metrics:
{'train/loss': tensor(2.1109), 'train/loss_step': tensor(1.8860), 'train/acc': tensor(0.4487), 'train/acc_step': tensor(0.7368), 'val/loss': tensor(1.8579), 'val/loss_epoch': tensor(1.8579), 'val/acc': tensor(0.7770), 'val/acc_epoch': tensor(0.7770), 'train/loss_epoch': tensor(2.1109), 'train/acc_epoch': tensor(0.4487)}
[2024-10-25 13:24:47,068][__main__][INFO] - Starting testing!
[2024-10-25 13:24:47,068][__main__][INFO] - Loading best checkpoint: /code/checkpoints/best_model.ckpt
[2024-10-25 13:24:47,069][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /code/checkpoints/best_model.ckpt
[2024-10-25 13:24:47,138][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /code/checkpoints/best_model.ckpt
[2024-10-25 13:24:51,622][__main__][INFO] - Test metrics:
[{'test/loss_epoch': 1.842276692390442, 'test/acc_epoch': 0.8192771077156067}]
