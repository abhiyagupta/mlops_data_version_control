[2024-10-25 13:07:22,301][__main__][INFO] - Instantiating datamodule <src.datamodules.dogs_datamodule.DogsBreedDataModule>
[2024-10-25 13:07:23,335][__main__][INFO] - Instantiating model <src.models.dogs_classifier.DogsBreedClassifier>
[2024-10-25 13:07:23,962][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
[2024-10-25 13:07:24,346][timm.models._hub][INFO] - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-10-25 13:07:24,357][timm.models._builder][INFO] - Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
[2024-10-25 13:07:24,364][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-10-25 13:07:24,368][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-10-25 13:07:24,370][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-10-25 13:07:24,370][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-10-25 13:07:24,371][__main__][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-10-25 13:07:24,374][__main__][INFO] - Instantiating logger <lightning.pytorch.loggers.tensorboard.TensorBoardLogger>
[2024-10-25 13:07:24,377][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-10-25 13:07:24,385][pytorch_lightning.utilities.rank_zero][INFO] - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[2024-10-25 13:07:24,400][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: False, used: False
[2024-10-25 13:07:24,400][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-10-25 13:07:24,400][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-10-25 13:07:24,401][__main__][INFO] - Starting training!
[2024-10-25 13:07:24,401][src.datamodules.dogs_datamodule][INFO] - Checking for dataset in: /code/data/dogs_dataset/dataset
[2024-10-25 13:07:24,401][src.datamodules.dogs_datamodule][INFO] - Dataset not found. Downloading...
[2024-10-25 13:07:25,313][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-10-25 13:08:29,402][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer.fit` stopped: `max_epochs=1` reached.
[2024-10-25 13:08:29,413][__main__][INFO] - Training metrics:
{'train/loss': tensor(2.1068), 'train/loss_step': tensor(1.8923), 'train/acc': tensor(0.4086), 'train/acc_step': tensor(0.8261), 'val/loss': tensor(1.7189), 'val/loss_epoch': tensor(1.7189), 'val/acc': tensor(0.9137), 'val/acc_epoch': tensor(0.9137), 'train/loss_epoch': tensor(2.1068), 'train/acc_epoch': tensor(0.4086)}
[2024-10-25 13:08:29,414][__main__][INFO] - Starting testing!
[2024-10-25 13:08:29,414][__main__][INFO] - Loading best checkpoint: /code/checkpoints/best_model.ckpt
[2024-10-25 13:08:29,415][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /code/checkpoints/best_model.ckpt
[2024-10-25 13:08:29,472][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /code/checkpoints/best_model.ckpt
[2024-10-25 13:08:34,571][__main__][INFO] - Test metrics:
[{'test/loss_epoch': 1.817720890045166, 'test/acc_epoch': 0.8092783689498901}]
