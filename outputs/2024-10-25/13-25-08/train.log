[2024-10-25 13:25:08,380][__main__][INFO] - Instantiating datamodule <src.datamodules.dogs_datamodule.DogsBreedDataModule>
[2024-10-25 13:25:09,464][__main__][INFO] - Instantiating model <src.models.dogs_classifier.DogsBreedClassifier>
[2024-10-25 13:25:10,179][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
[2024-10-25 13:25:10,601][timm.models._hub][INFO] - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2024-10-25 13:25:10,612][timm.models._builder][INFO] - Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
[2024-10-25 13:25:10,619][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2024-10-25 13:25:10,622][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.EarlyStopping>
[2024-10-25 13:25:10,623][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2024-10-25 13:25:10,624][__main__][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2024-10-25 13:25:10,624][__main__][INFO] - Instantiating logger <lightning.pytorch.loggers.csv_logs.CSVLogger>
[2024-10-25 13:25:10,627][__main__][INFO] - Instantiating logger <lightning.pytorch.loggers.tensorboard.TensorBoardLogger>
[2024-10-25 13:25:10,631][__main__][INFO] - Instantiating trainer <lightning.Trainer>
[2024-10-25 13:25:10,640][pytorch_lightning.utilities.rank_zero][INFO] - Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
[2024-10-25 13:25:10,656][pytorch_lightning.utilities.rank_zero][INFO] - GPU available: False, used: False
[2024-10-25 13:25:10,656][pytorch_lightning.utilities.rank_zero][INFO] - TPU available: False, using: 0 TPU cores
[2024-10-25 13:25:10,656][pytorch_lightning.utilities.rank_zero][INFO] - HPU available: False, using: 0 HPUs
[2024-10-25 13:25:10,657][__main__][INFO] - Starting training!
[2024-10-25 13:25:10,657][src.datamodules.dogs_datamodule][INFO] - Checking for dataset in: /code/data/dogs_dataset/dataset
[2024-10-25 13:25:10,657][src.datamodules.dogs_datamodule][INFO] - Dataset already exists.
[2024-10-25 13:25:10,979][pytorch_lightning.utilities.rank_zero][INFO] - Loading `train_dataloader` to estimate number of stepping batches.
[2024-10-25 13:26:11,977][pytorch_lightning.utilities.rank_zero][INFO] - `Trainer.fit` stopped: `max_epochs=1` reached.
[2024-10-25 13:26:11,995][__main__][INFO] - Training metrics:
{'train/loss': tensor(2.1009), 'train/loss_step': tensor(1.9438), 'train/acc': tensor(0.3983), 'train/acc_step': tensor(0.5263), 'val/loss': tensor(1.8732), 'val/loss_epoch': tensor(1.8732), 'val/acc': tensor(0.7482), 'val/acc_epoch': tensor(0.7482), 'train/loss_epoch': tensor(2.1009), 'train/acc_epoch': tensor(0.3983)}
[2024-10-25 13:26:11,996][__main__][INFO] - Starting testing!
[2024-10-25 13:26:11,996][__main__][INFO] - Loading best checkpoint: /code/checkpoints/best_model.ckpt
[2024-10-25 13:26:11,997][pytorch_lightning.utilities.rank_zero][INFO] - Restoring states from the checkpoint path at /code/checkpoints/best_model.ckpt
[2024-10-25 13:26:12,066][pytorch_lightning.utilities.rank_zero][INFO] - Loaded model weights from the checkpoint at /code/checkpoints/best_model.ckpt
